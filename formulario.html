<!DOCTYPE html>
<html>
<head>
<style>
  input[type=number], input[type=password] {
    width: 100px;
  }
  #timer {
    font-size: 20px;
    color: green;
  }
  #queue {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  #queue li {
    margin: 5px;
    padding: 10px;
    border: 1px solid black;
  }
</style>
<script>
  // Função para formatar o tempo em minutos e segundos
  function formatTime(seconds) {
    let minutes = Math.floor(seconds / 60);
    let seconds = seconds % 60;
    if (minutes < 10) minutes = "0" + minutes;
    if (seconds < 10) seconds = "0" + seconds;
    return minutes + ":" + seconds;
  }

  // Função para calcular o valor a ser cobrado por minuto
  function calculateValue(minutes) {
    let rate = 2.30; // Taxa em reais por minuto
    return (minutes * rate).toFixed(2);
  }

  // Função para iniciar o contador de tempo
  function startTimer() {
    // Pegar o número da ordem de serviço do input
    let orderNumber = document.getElementById("order-number").value;
    // Verificar se o input não está vazio e se é um número válido
    if (orderNumber && !isNaN(orderNumber)) {
      // Adicionar o número da ordem de serviço na fila
      let queue = document.getElementById("queue");
      let li = document.createElement("li");
      li.id = "order-" + orderNumber;
      li.innerHTML = "Ordem de serviço: " + orderNumber;
      queue.appendChild(li);
      // Verificar se a fila tem apenas uma ordem
      if (queue.childElementCount == 1) {
        // Iniciar o contador para a primeira ordem da fila
        runTimer(orderNumber);
      } else {
        // Mostrar uma mensagem de que a ordem está na fila
        alert("Ordem de serviço " + orderNumber + " adicionada na fila.");
      }
      // Limpar o input
      document.getElementById("order-number").value = "";
    } else {
      // Mostrar um alerta de erro se o input estiver vazio ou inválido
      alert("Por favor, digite um número válido para a ordem de serviço.");
    }
  }

  // Função para executar o contador de tempo para uma ordem específica
  function runTimer(orderNumber) {
    // Desabilitar o botão de iniciar
    document.getElementById("start-button").disabled = true;
    // Mostrar o número da ordem de serviço na tela
    document.getElementById("order-display").innerHTML = "Ordem de serviço: " + orderNumber;
    // Definir o tempo inicial em segundos (1 hora = 3600 segundos)
    let time = 3600;
    // Mostrar o tempo inicial na tela
    document.getElementById("timer").innerHTML = formatTime(time);
    // Criar um intervalo que executa a cada segundo
    let interval = setInterval(function() {
      // Decrementar o tempo em um segundo
      time--;
      // Mostrar o tempo atualizado na tela
      document.getElementById("timer").innerHTML = formatTime(time);
      // Verificar se o tempo acabou
      if (time == 0) {
        // Parar o intervalo
        clearInterval(interval);
        // Mostrar uma mensagem de fim de tempo na tela
        document.getElementById("timer").innerHTML = "Fim do tempo!";
        // Calcular o valor a ser cobrado pela ordem de serviço
        let value = calculateValue(60); // 60 minutos
        // Mostrar o valor na tela
        document.getElementById("value-display").innerHTML = "Valor a ser cobrado: R$ " + value;
        // Habilitar o botão de finalizar
        document.getElementById("finish-button").disabled = false;
        // Guardar a referência do intervalo e do número da ordem
        document.getElementById("finish-button").interval = interval;
        document.getElementById("finish-button").orderNumber = orderNumber;
      }
    }, 1000); // Executar a cada 1000 milissegundos (1 segundo)
  }

  // Função para finalizar a ordem de serviço atual
  function finishOrder() {
    // Parar o intervalo
    let interval = document.getElementById("finish-button").interval;
    clearInterval(interval);
    // Pegar o número da ordem de serviço
    let orderNumber = document.getElementById("finish-button").orderNumber;
    // Remover a ordem de serviço da fila
    let queue = document.getElementById("queue");
    let li = document.getElementById("order-" + orderNumber);
    queue.removeChild(li);
    // Limpar a tela
    document.getElementById("order-display").innerHTML = "";
    document.getElementById("timer").innerHTML = "";
    document.getElementById("value-display").innerHTML = "";
    // Desabilitar o botão de finalizar
    document.getElementById("finish-button").disabled = true;
    // Verificar se a fila ainda tem ordens
    if (queue.childElementCount > 0) {
      // Pegar o número da próxima ordem de serviço
      let nextOrderNumber = queue.firstElementChild.id.split("-")[1];
      // Aguardar um minuto antes de iniciar a próxima ordem
      setTimeout(function() {
        runTimer(nextOrderNumber);
      }, 60000); // 60000 milissegundos (1 minuto)
    } else {
      // Habilitar o botão de iniciar novamente
      document.getElementById("start-button").disabled = true;
    }
  }

  // Função para verificar a senha antes de acessar a página
  function checkPassword() {
    // Pegar a senha do input
    let password = document.getElementById("1234").value;
    // Definir a senha correta (pode ser alterada)
    let correctPassword = "1234";
    // Comparar as senhas e mostrar ou esconder os elementos da página
    if (password == correctPassword) {
      document.getElementById("password-section").style.display = "none";
      document.getElementById("page-section").style.display = "block";
    } else {
      alert("Senha incorreta.");
    }
  }
</script>
</head>
<body>
<h1>Sistema de ordens de serviço</h1>
<div id="password-section">
<p>Insira a senha para acessar a página.</p>
<input type="password" id="password" />
<button id="check-button" onclick="checkPassword()">Verificar</button>
</div>
<div id="page-section" style="display: none;">
<p>Insira o número da ordem de serviço e clique em iniciar.</p>
<input type="number" id="order-number" />
<button id="start-button" onclick="startTimer()">Iniciar</button>
<button id="finish-button" onclick="finishOrder()" disabled>Finalizar</button>
<p id="order-display"></p>
<p id="timer"></p>
<p id="value-display"></p>
<ul id="queue"></ul>
</div>
</body>
</html>
